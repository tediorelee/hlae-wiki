(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{237:function(e,t,a){"use strict";a.r(t);var s=a(0),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("This command accesses the HLAE / AfxHookSource streams system.")]),e._v(" "),a("h1",{attrs:{id:"supported-games"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#supported-games"}},[e._v("#")]),e._v(" Supported Games")]),e._v(" "),a("p",[e._v("Only Counter-Strike: Global Offensive is supported.")]),e._v(" "),a("h1",{attrs:{id:"current-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#current-limitations"}},[e._v("#")]),e._v(" Current Limitations")]),e._v(" "),a("ul",[a("li",[e._v("Special materials with special shaders can be problematic (inaccurate)")]),e._v(" "),a("li",[e._v("Due to breakage in HLAE replacement shaders with the February 17th 2016 CS:GO update, the streams are much less accurate than they used to be before (meaning on the matte / depths streams as before the big HLAE update smoke won't draw, transparent stuff will be problematic, cables/ropes won't draw and so on).")])]),e._v(" "),a("h1",{attrs:{id:"things-you-should-know"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#things-you-should-know"}},[e._v("#")]),e._v(" Things you should know")]),e._v(" "),a("p",[e._v("You should only use the default preview slot (meaning only 1 stream in preview), since the multi-stream preview is bugged.")]),e._v(" "),a("p",[e._v("Streams are created with drawViewModel -1 and drawHud 0 as default for backwards compatiblity. You might want to set the drawHud property to -1 (-1 means use the game default for those two). For examples see below.")]),e._v(" "),a("p",[e._v("You will notice that available sub-commands for "),a("tt",[e._v("mirv_streams edit")]),e._v(" are specific to the stream type you are editing. Meaning some streams have different options than others, some have only a few options.")],1),e._v(" "),a("p",[e._v("You should also follow the advice in the [[smoother demos guide|Source:Smoother-Demos]] to reduce jitter/lag in recordings.")]),e._v(" "),a("h1",{attrs:{id:"built-in-command-help-navigation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#built-in-command-help-navigation"}},[e._v("#")]),e._v(" Built in command help / navigation")]),e._v(" "),a("p",[e._v("The manual doesn't cover all the options available through the mirv_streams command. Basically enter the mirv_streams command or it's sub commands to get help for the current (sub-)command. If the help displays a subcommand with "),a("tt",[e._v("[...]")]),e._v(" behind it, then you can enter everything in-front to get more help for that sub-command.")],1),e._v(" "),a("p",[e._v("If you mistype anything after mirv_streams, then it will print the most specific (sub-)command help it can find.")]),e._v(" "),a("h1",{attrs:{id:"examples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[e._v("#")]),e._v(" Examples")]),e._v(" "),a("h2",{attrs:{id:"_1-adding-a-depth-stream-and-previewing-it-and-editing-it-a-bit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-adding-a-depth-stream-and-previewing-it-and-editing-it-a-bit"}},[e._v("#")]),e._v(" 1. Adding a depth stream and previewing it and editing it a bit")]),e._v(" "),a("p",[e._v("To add a depth stream named "),a("em",[e._v("mydepth")]),e._v(" enter this:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add depth mydepth")])],1),e._v(" "),a("p",[e._v("Now put the stream into preview:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams preview mydepth")])],1),e._v(" "),a("p",[e._v("You should be able to see the depth stream preview now.")]),e._v(" "),a("p",[e._v("Now lets edit the maximum depth value of the stream we added, since the default of 1024 is a bit low:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit mydepth depthValMax 4096.0")])],1),e._v(" "),a("p",[e._v("To check if the value has been set properly enter:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit mydepth depthValMax")]),a("br"),e._v("\nIt should display the "),a("em",[e._v("current value")]),e._v(".")],1),e._v(" "),a("h2",{attrs:{id:"_2-adding-a-normal-stream"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-adding-a-normal-stream"}},[e._v("#")]),e._v(" 2. Adding a normal stream")]),e._v(" "),a("p",[e._v("A normal stream is simply a stream that doesn't have much possible settings, you can use it to record the view without special effects.")]),e._v(" "),a("p",[e._v("Enter this in console to add a normal stream named "),a("em",[e._v("mynormal")]),e._v(":"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add normal mynormal")])],1),e._v(" "),a("p",[e._v("Enter this in console to make the stream you just added draw the HUD when the game draws it:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit mynormal drawHud -1")])],1),e._v(" "),a("p",[e._v("Preview that stream using:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams preview mynormal")])],1),e._v(" "),a("h2",{attrs:{id:"_3-adding-a-matte-entity-stream-and-previewing-it"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-adding-a-matte-entity-stream-and-previewing-it"}},[e._v("#")]),e._v(" 3. Adding a matte entity stream and previewing it")]),e._v(" "),a("p",[e._v("Enter this in console to add a matteEntity stream named "),a("em",[e._v("mymatte")]),e._v(":"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add matteEntity mymatte")])],1),e._v(" "),a("p",[e._v("Preview that stream using:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams preview mymatte")])],1),e._v(" "),a("p",[e._v("The normal stream is if you need to record an additional normal view, it has much less options than other streams.")]),e._v(" "),a("h2",{attrs:{id:"_4-marking-streams-as-do-not-record-or-record"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-marking-streams-as-do-not-record-or-record"}},[e._v("#")]),e._v(" 4. Marking streams as do not record or record")]),e._v(" "),a("p",[e._v("Enter this in console to mark a stream named "),a("em",[e._v("mymatte")]),e._v(" as do not record:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit "),a("em",[e._v("mymatte")]),e._v(" record 0")]),a("br"),e._v("\nThis will cause the stream to not be recorded when using "),a("tt",[e._v("mirv_streams record")]),e._v(".")],1),e._v(" "),a("p",[e._v("If you want to check that the setting has been applied enter:\n"),a("tt",[e._v("mirv_streams edit "),a("em",[e._v("mymatte")]),e._v(" record")]),a("br"),e._v("\nIt should display the "),a("em",[e._v("current value")]),e._v(".")],1),e._v(" "),a("h2",{attrs:{id:"_5-stop-previewing-a-stream"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-stop-previewing-a-stream"}},[e._v("#")]),e._v(" 5. Stop previewing a stream")]),e._v(" "),a("p",[e._v("To stop previewing a stream there are two ways:"),a("br"),e._v(" "),a("tt",[e._v('mirv_streams preview ""')]),e._v(" or "),a("tt",[e._v("mirv_streams previewend")])],1),e._v(" "),a("h2",{attrs:{id:"_6-a-more-complete-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-a-more-complete-example"}},[e._v("#")]),e._v(" 6. A more complete example")]),e._v(" "),a("p",[e._v("First lets remove the streams from the previous examples (you can skip that if you didn't add them):"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams remove mydepth")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams remove mymatte")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams remove mynormal")])],1),e._v(" "),a("p",[e._v("Now let's add a few streams named "),a("em",[e._v("ent")]),e._v(" (contains the entities and the world is masked), "),a("em",[e._v("wrld")]),e._v(" (contains everything masked or missing in "),a("em",[e._v("ent")]),e._v("), "),a("em",[e._v("dent")]),e._v(" (depth for "),a("em",[e._v("ent")]),e._v(") and "),a("em",[e._v("dwrld")]),e._v(" (depth for "),a("em",[e._v("wrld")]),e._v("):"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add matteEntity ent")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add matteWorld wrld")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add depthEntity dent")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit dent depthValMax 4096")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add depthWorld dwrld")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit dwrld depthValMax 4096")])],1),e._v(" "),a("p",[e._v("Now for extra fun (let's pretend we hate weapon stickers), let's add a stream without weapon stickers, that we put into preview but don't record:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add baseFx nostickers")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit nostickers stickerAction invisible")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit nostickers record 0")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams preview nostickers")])],1),e._v(" "),a("h3",{attrs:{id:"recording-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recording-example"}},[e._v("#")]),e._v(" Recording example:")]),e._v(" "),a("p",[e._v("Here is a complete example how to record the streams set up above:")]),e._v(" "),a("p",[e._v("First let's set the record name to "),a("em",[e._v("test_rec")]),e._v(" (default is "),a("em",[e._v("untitled")]),e._v("):"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams record name test_rec")])],1),e._v(" "),a("p",[a("strong",[e._v("Hint:")]),e._v(" Alternatively you can set a full folderpath i.e. "),a("tt",[e._v('mirv_streams record name "d:\\myFolderPath"')]),e._v("!")],1),e._v(" "),a("p",[e._v("Now let's record:"),a("br"),e._v(" "),a("tt",[e._v("host_framerate 60; host_timescale 0; [[mirv_snd_timescale|Source:mirv_snd_timescale]] 1; mirv_streams record start")])],1),e._v(" "),a("p",[e._v("... record a bit ...")]),e._v(" "),a("p",[e._v("Now stop the recording:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams record end; host_framerate 0")])],1),e._v(" "),a("p",[e._v("If everything went well, you should now have the recorded image files and audio file in the "),a("tt",[e._v("Counter-Strike Global Offensive\\test_rec")]),e._v(" folder (except if you set another folder path in the steps above, then they will be there).")],1),e._v(" "),a("h2",{attrs:{id:"adding-a-depth-stream-with-up-to-23bit-precision-openexr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adding-a-depth-stream-with-up-to-23bit-precision-openexr"}},[e._v("#")]),e._v(" Adding a depth stream with up to 23bit precision (OpenEXR):")]),e._v(" "),a("p",[a("em",[e._v("The actual accuracy is about 23 bits maximum. Depending on your graphics card and drivers the accuracy can be much lower, however with modern cards and drivers you should be close to the 23 bit maximum accuracy.")])]),e._v(" "),a("p",[e._v("Then depth value of the OpenEXR files will be between the stream's depthVal and depthValMax. If it's not exactly one of these values, then the depth value can be assumed to be the actual distance in 12/16 = 0.75 inch from the camera. If the value is the minimum value (depthVal), then the distance is depthVal or less. If the value is the maximum value (depthValMax), the the distance is depthValMax or above.")]),e._v(" "),a("p",[e._v("There are two methods to get high precision depth / OpenEXR support:")]),e._v(" "),a("h3",{attrs:{id:"openexr-depth-stream-the-latest-way"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openexr-depth-stream-the-latest-way"}},[e._v("#")]),e._v(" OpenEXR depth stream - The latest way")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mirv_streams add depth depth\nmirv_streams edit depth depthVal 1\nmirv_streams edit depth depthValMax 8192 // or higher\nmirv_streams edit depth drawZ rgb\nmirv_streams edit depth drawZMode linear\nmirv_streams edit depth captureType depth24\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])]),a("h3",{attrs:{id:"openexr-depthf-stream-currently-broken"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openexr-depthf-stream-currently-broken"}},[e._v("#")]),e._v(" OpenEXR depthF stream [currently broken]")]),e._v(" "),a("p",[e._v("Enter the following lines into console:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add depth myDepthF")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit myDepthF depthValMax 8192.0")]),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit myDepthF captureType depthF ")])],1),e._v(" "),a("p",[e._v("If you want to have the OpenEXR files with ZIP compression (probably slower), then use "),a("tt",[e._v("depthFZIP")]),e._v(" instead of "),a("tt",[e._v("depthF")]),e._v(".")],1),e._v(" "),a("h3",{attrs:{id:"openexr-depth-stream-the-oldschool-way"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openexr-depth-stream-the-oldschool-way"}},[e._v("#")]),e._v(" OpenEXR depth stream - The oldschool way")]),e._v(" "),a("p",[a("strong",[e._v("This option is not available at the moment, due to the February 17th CS:GO update!")])]),e._v(" "),a("p",[a("strong",[e._v("Please note:")])]),e._v(" "),a("ul",[a("li",[e._v("When using this method "),a("em",[e._v("you need to disable any anti aliasing")]),e._v(", because that would cause unwanted artefacts with the colour coded depth information!")]),e._v(" "),a("li",[e._v("This oldschool method doesn't support alpha blending of depth values, it instead does a binary alpha test and either renders or discards the incoming pixels based on that.")])]),e._v(" "),a("p",[e._v("First we tell HLAE to add a depth stream:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams add depth mydepth24")]),a("br")],1),e._v(" "),a("p",[e._v("Next we tell it to raise the maximal distance to 8192.0 (we can do this, since we will have a lot more precision now):"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit mydepth24 depthValMax 8192.0")]),a("br")],1),e._v(" "),a("p",[e._v("Next we tell it to manipulate the stream by making a stream suitable for the depth24 capturing:"),a("br"),e._v(" "),a("tt",[e._v("mirv_streams edit mydepth24 man toDepth24")]),a("br")],1),e._v(" "),a("p",[e._v("If you want to have the OpenEXR files with ZIP compression (probably slower) use "),a("tt",[e._v("toDepth24ZIP")]),e._v(" instead of "),a("tt",[e._v("toDepth24")]),e._v(".")],1),e._v(" "),a("h2",{attrs:{id:"quick-view-model-matte"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quick-view-model-matte"}},[e._v("#")]),e._v(" Quick view model matte")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// Quick black and white viewmodel mask:\nmirv_streams add depth vmm\nmirv_streams edit vmm detphVal 15 // use 7 if you want gray scale\nmirv_streams edit vmm depthValMax 15 // note shells ejected are further away, because the game munges the depth of the viewmodel to have it on-top\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h1",{attrs:{id:"ffmpeg-image-stream-encoding-to-video"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg-image-stream-encoding-to-video"}},[e._v("#")]),e._v(" FFMPEG image stream encoding (to video):")]),e._v(" "),a("p",[e._v("First follow the instructions in "),a("code",[e._v("ffmpeg/readme.advancedfx.txt")]),e._v(" (in HLAE folder) to install FFMPEG for HLAE.")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// Example usage:\nhost_framerate 120\nmirv_streams add normal norm\nmirv_streams edit norm settings afxFfmpegYuv420p\nmirv_streams add depth depth\nmirv_streams edit depth settings afxFfmpegLosslessBest\nmirv_streams record start\n// ...\nmirv_streams record end\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("p",[e._v("Hint: You can add custom profiles / see the other default profiles by using the mirv_streams settings command.")]),e._v(" "),a("p",[e._v('Notice: Many video programs and browsers can not decode the depth streams, because they are "monochromatic rgb". Also '),a("strong",[e._v("we recommend afxFfmpeg over afxFfmpegYuv420p, both are lossy")]),e._v(", but the former has better color quality, while many programs and browsers can only handle the latter.")]),e._v(" "),a("h1",{attrs:{id:"sampling-system"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sampling-system"}},[e._v("#")]),e._v(" Sampling System")]),e._v(" "),a("p",[e._v("There is a default 30 down-sampler setting named afxSampler30 in afxSettings. If you want to change settings (e.g. output fps, please add a new sampler using "),a("code",[e._v("mirv_streams settings add [...]")]),e._v(" and edit that one.")]),e._v(" "),a("p",[e._v("Example usage:")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mirv_streams settings edit afxSampler30 settings afxClassic // if you have FFMPEG installed for HLAE, you can use one of those settings (e.g. afxFfmpegYuv420p) instead of afxClassic\nmirv_streams settings edit afxDefault settings afxSampler30\nmirv_streams add normal myNorm\n\n// Start recording:\nhost_framerate 1200; mirv_streams record start\n\n// End recording:\nmirv_streams record end; host_framerate 0\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("p",[e._v("Please avoid cascading samplers for now, since that will probably cause problems, since HLAE will refuse to allocate more than 3 image buffers at the same time and just lock up waiting for a buffer to get available.")]),e._v(" "),a("h1",{attrs:{id:"related-tutorials"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#related-tutorials"}},[e._v("#")]),e._v(" Related tutorials")]),e._v(" "),a("ul",[a("li",[e._v("[[Source:Smoother-Demos]]")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://youtu.be/7Mnbr-3RvPs",target:"_blank",rel:"noopener noreferrer"}},[e._v("Removing Volumetric Lights from Depth Passes in HLAE (Picker Method)"),a("OutboundLink")],1),e._v(" by xNWP")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://youtu.be/7gIPtqg-Gsg",target:"_blank",rel:"noopener noreferrer"}},[e._v("HLAE Picker Tool (Removing Players)"),a("OutboundLink")],1),e._v(" by Alan Gaming")]),e._v(" "),a("li",[e._v("[[Tutorial: CS:GO Separate HUD Stream]]")])]),e._v(" "),a("h1",{attrs:{id:"see-also"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#see-also"}},[e._v("#")]),e._v(" See also")]),e._v(" "),a("ul",[a("li",[e._v("[[Source:Commands]]")])])])}),[],!1,null,null,null);t.default=r.exports}}]);